---
title: "CVE-2021-22908"
description: "Pulse Connect Secure Samba buffer overflow"
vulnid: "667933"
draft: false
toc: true
vendors: ['Ivanti', 'Pulse Secure']
---
### Solution

#### Apply an update

This issue is addressed in PCS 9.1R11.5. Please see advisory [SA44800](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800) for more details.

#### Apply an XML workaround

Pulse Secure has published advisory [SA44800](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800) that mentions a [Workaround-2105.xml](https://my.pulsesecure.net/) file that contains a mitigation to protect against this vulnerability. [Importing this XML workaround](https://docs.pulsesecure.net/WebHelp/PCS/9.1R1/AG/Content/PCS/PCS_AdminGuide_9.1R1/Importing_an_XML_Configuration.htm) will activate the protections immediately and does not require any downtime for the VPN system. This workaround will block requests that match the following URI patterns:
```
^/+dana/+fb/+smb
^/+dana-cached/+fb/+smb
```

`Workaround-2105.xml` will automatically deactivate the mitigations applied by `Workaround-2104.xml` when it is installed. As such, it is imperative that a PCS system is running 9.1R11.4 **before** applying the `Workaround-2105.xml` mitigation, which will ensure that the vulnerabilities outlined in [SA44784](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784) are not reintroduced as the result of applying this workaround.

Note that installing this workaround will block the ability to use the following feature:

* Windows File Share Browser

#### Set a Windows File Access Policy

This vulnerability relies on the ability to connect to an arbitrary SMB server name to trigger the vulnerability. A PCS system that started as version 9.1R3 or later will have a default Initial File Browsing Policy of **Deny** for `\\*` SMB connections. If you have a PCS system that started as 9.1R2 or earlier, it will retain the default Initial File Browsing Policy of **Allow** for `\\*` SMB connections, which will expose this vulnerability. In the administrative page for the PCS, see `Users -> Resource Policies -> Windows File Access Policies` to view your current SMB policy.

If your PCS has a policy that explicitly allows `\\*` or otherwise may allow users to initiate connections to arbitrary SMB server names, you should configure the PCS to **Deny** connections to such resources to minimize your PCS attack surface.

### References

* <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800>
* <https://github.com/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/cve-2021-22908.py>

* <https://www.kb.cert.org/vuls/id/667933>