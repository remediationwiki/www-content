---
title: CVE-2020-1472
description: Microsoft Windows Netlogon Remote Protocol (MS-NRPC) uses insecure
  AES-CFB8 initialization vector
vulnid: "490028"
draft: false
toc: true
vendors:
  - Alpine Linux
  - Arch Linux
  - CentOS
  - Debian GNU/Linux
  - Fedora Project
  - Geexbox
  - Gentoo Linux
  - Google
  - HardenedBSD
  - Micro Focus
  - Microsoft
  - NetBSD
  - Red Hat
  - SUSE Linux
  - Samba
  - Slackware Linux Inc.
  - Synology
  - Turbolinux
  - Ubuntu
  - Univention
  - Blackberry QNX
  - F5 Networks Inc.
  - FreeBSD Project
  - Illumos
  - Joyent
  - Amazon
  - Apple
  - Arista Networks Inc.
  - Aspera Inc.
  - Dell EMC
  - DesktopBSD
  - DragonFly BSD Project
  - HP Inc.
  - Hewlett Packard Enterprise
  - Hitachi
  - IBM Numa-Q Division (Formerly Sequent)
  - Juniper Networks
  - Lenovo
  - Marconi Inc.
  - NEC Corporation
  - Nexenta
  - Nokia
  - OpenBSD
  - OpenIndiana
  - Openwall GNU/*/Linux
  - Oracle Corporation
  - Sony
  - The OpenBSD project
  - Tizen
  - TrueOS
  - Unisys Corporation
  - m0n0wall
---
### Solution

#### Apply an update - this is updated content

On August 11, 2020, Microsoft issued [an advisory](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472) that provides updates for this vulnerability.

#### Enable secure RPC enforcement mode

The August 2020 updates for CVE-2020-1472 include changes to domain controllers that can optionally be enabled to [require secure RPC](https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc) for Netlogon secure channel connections. The changes to require secure RPC must be made to receive the most complete protection from this vulnerability. For systems that have the August 2020 update for CVE-2020-1472, enabling secure RPC [enforcement mode](https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc#EnforcementMode) will change domain controller behavior to require Netlogon secure channel connections using secure [MS-NRPC](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/ff8f970f-3e37-40f7-bd4b-af7336e4792f). This change to enable enforcement mode will be deployed automatically on or after February 9, 2021.

### References

* <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472>
* <https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc>
* <https://techcommunity.microsoft.com/t5/microsoft-365-defender/zerologon-is-now-detected-by-microsoft-defender-for-identity-cve/ba-p/1734034>
* <https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/13db7494-6d2c-4448-be8f-cb5ba03e95d6>
* <https://www.secura.com/pathtoimg.php?id=2055>
* <https://www.samba.org/samba/security/CVE-2020-1472.html>
* <https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html#SERVERSCHANNEL>
* <https://github.com/SecuraBV/CVE-2020-1472>
* <https://github.com/dirkjanm/CVE-2020-1472>
* <https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon>
* <https://github.com/CERTCC/PoC-Exploits/tree/master/cve-2020-1472>
* <https://blog.rapid7.com/2020/09/14/cve-2020-1472-zerologon-critical-privilege-escalation/>
* <https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20200916>
* <https://nakedsecurity.sophos.com/2020/09/17/zerologon-hacking-windows-servers-with-a-bunch-of-zeros/>

* <https://www.kb.cert.org/vuls/id/490028>