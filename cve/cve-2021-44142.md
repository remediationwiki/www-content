---
title: "CVE-2021-44142"
description: "Samba vfs_fruit module insecurely handles extended file attributes"
vulnid: "119678"
draft: false
toc: true
vendors: ['Red Hat', 'Samba', 'SUSE Linux', 'Synology', 'Ubuntu', 'Advantech Czech', 'Android Open Source Project', 'Aruba Networks', 'AVM GmbH', 'Check Point', 'Dell SecureWorks', 'Devicescape', 'eCosCentric', 'Espressif Systems', 'F5 Networks', 'Fastly', 'HardenedBSD', 'Illumos', 'Internet Initiative Japan Inc.', 'Joyent', 'Juniper Networks', 'LANCOM Systems GmbH', 'lwIP', 'Microsoft', 'MikroTik', 'Miredo', 'Muonics Inc.', 'netsnmp', 'Sierra Wireless', 'Treck', 'A10 Networks', 'ACCESS', 'Actelis Networks', 'Actiontec', 'ADATA', 'ADTRAN', 'Advantech', 'Advantech B-B Technology', 'Aerohive', 'AhnLab Inc', 'AirWatch', 'Akamai Technologies Inc.', 'Alcatel-Lucent Enterprise', 'Allied Telesis', 'Alpine Linux', 'Altran Intelligent Systems', 'Amazon', 'ANTlabs', 'Apple', 'Arcadyan', 'Arch Linux', 'Arista Networks', 'ARRIS', 'ASUSTeK Computer Inc.', 'Atheros Communications Inc', 'AT&T', 'Avaya', 'Barracuda Networks', 'Belden', 'Belkin Inc.', 'Bell Canada Enterprises', 'BlackBerry', 'Blackberry QNX', 'BlueCat Networks Inc.', 'Blue Coat Systems', 'Blunk Microsystems', 'BoringSSL', 'Broadcom', 'Brocade Communication Systems', 'Buffalo Technology', 'Cambium Networks', 'CA Technologies', 'Ceragon Networks Inc', 'Cirpack', 'Cisco', 'Citrix', 'CMX Systems', 'Comcast', 'Commscope', 'Contiki OS', 'Cradlepoint', 'Cricket Wireless', 'Cypress Semiconductor', 'CZ.NIC', 'dd-wrt', 'Debian GNU/Linux', 'Dell', 'Dell EMC', 'DesktopBSD', 'Deutsche Telekom', 'Digi International', 'D-Link Systems Inc.', 'dnsmasq', 'DragonFly BSD Project', 'eero', 'EfficientIP', 'ENEA', 'Ericsson', 'European Registry for Internet Domains', 'Express Logic', 'Extreme Networks', 'Fedora Project', 'FNet', 'Force10 Networks', 'Fortinet', 'FreeBSD', 'FreeRTOS', 'F-Secure Corporation', 'Gentoo Linux', 'GFI Software', 'GNU adns', 'GNU glibc', 'Google', 'Grandstream', 'Green Hills Software', 'HCC Embedded', 'Hewlett Packard Enterprise', 'Hitachi', 'Honeywell', 'HP Inc.', 'HTC', 'Huawei', 'IBM', 'IBM Corporation (zseries)', 'IBM Numa-Q Division (Formerly Sequent)', 'ICASI', 'Infoblox', 'InfoExpress Inc.', 'Inmarsat', 'Intel', 'Internet Systems Consortium', 'Internet Systems Consortium - DHCP', 'IP Infusion Inc.', 'JH Software', 'JPCERT/CC Vulnerability Handling Team', 'kubernetes', 'Lancope', 'Lantronix', 'Lenovo', 'LG Electronics', 'LibreSSL', 'Linksys', 'LITE-ON Technology Corporation', 'LiteSpeed Technologies', 'Lynx Software Technologies', 'm0n0wall', 'Marconi Inc.', 'Marvell Semiconductor', 'McAfee', 'MediaTek', 'Medtronic', 'Men & Mice', 'Metaswitch Networks', 'Microchip Technology', 'Micro Focus', 'Mitel Networks', 'Motorola', 'National Cyber Security Center Netherlands', 'National Cyber Security Centre Finland', 'NCSC-FI Vulnerability Coordinator', 'NEC Corporation', 'NetBSD', 'NetBurner', 'NetComm Wireless Limited', 'NETGEAR', 'NETSCOUT', 'netsnmpj', 'Nexenta', 'NIKSUN', 'Nixu', 'NLnet Labs', 'Nokia', 'OleumTech', 'OpenBSD', 'OpenConnect Ltd', 'OpenDNS', 'OpenIndiana', 'OpenSSL', 'Openwall GNU/*/Linux', 'OpenWRT', 'Oracle Corporation', 'Oryx Embedded', 'Paessler', 'Palo Alto Networks', 'Peplink', 'pfSense', 'Philips Electronics', 'Phoenix Contact', 'PHPIDS', 'PowerDNS', 'Proxim Inc.', 'Pulse Secure', 'QLogic', 'QNAP', 'Quadros Systems', 'Quagga', 'Qualcomm', 'Quantenna Communications', 'Riverbed Technologies', 'Roku', 'Ruckus Wireless', 'Ruijie Networks', 'Samsung', 'Samsung Mobile', 'Samsung Semiconductor', 'Schneider Electric', 'Secure64 Software Corporation', 'SEIKO EPSON Corp. / Epson America Inc.', 'Slackware Linux Inc.', 'SMC Networks Inc.', 'SmoothWall', 'Snort', 'SonicWall', 'Sonos', 'Sony', 'Sophos', 'Sourcefire', 'Symantec', 'systemd', 'TCPWave', 'TDS Telecom', 'Technicolor', 'Tenable Network Security', 'The OpenBSD project', 'TippingPoint Technologies Inc.', 'Tizen', 'TP-LINK', 'TrueOS', 'Turbolinux', 'Ubiquiti', 'Unisys Corporation', 'Univention', 'Untangle', 'VMware', 'Western Digital', 'Wind River', 'WizNET Technology', 'wolfSSL', 'Xiaomi', 'XigmaNAS', 'Xilinx', 'Zebra Technologies', 'Zephyr Project', 'ZTE Corporation', 'Zyxel']
---
### Solution

#### Apply an update

Samba has [released](https://www.samba.org/samba/security/CVE-2021-44142.html) versions 4.13.17, 4.14.12, and 4.15.5.

#### Disable vfs\_fruit

As a workaround, remove 'fruit' from 'vfs objects' lines in Samba configuration files (e.g., `smb.conf`).

### References

* <https://www.samba.org/samba/security/CVE-2021-44142.html>
* <https://bugzilla.samba.org/show_bug.cgi?id=14914>
* <https://www.zerodayinitiative.com/blog/2022/2/1/cve-2021-44142-details-on-a-samba-code-execution-bug-demonstrated-at-pwn2own-austin>
* <https://www.samba.org/samba/history/security.html>
* <https://www.samba.org/samba/docs/current/man-html/vfs_fruit.8.html>

* <https://www.kb.cert.org/vuls/id/119678>